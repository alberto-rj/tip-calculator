const form=document.getElementById("form"),billInput=document.getElementById("bill-input"),customTipInput=document.getElementById("custom-tip-input"),numberOfPeopleInput=document.getElementById("number-of-people-input"),inputs=[billInput,customTipInput,numberOfPeopleInput],radioInputs=document.querySelectorAll(".form__radio-input"),resetBtn=document.getElementById("reset-btn"),tipAmountHeading=document.getElementById("tip-amount-heading"),tipAmountData=document.getElementById("tip-amount-data"),totalHeading=document.getElementById("total-heading"),totalData=document.getElementById("total-data"),fadeInElements=[tipAmountHeading,tipAmountData,totalHeading,totalData,resetBtn];let currentTip=0;const addClass=(element,className)=>{element.classList.add(className)},removeCheckedRadioInput=()=>{radioInputs.forEach((input=>{input.checked&&(input.checked=!1)}))},removeClass=(element,className)=>{element.classList.remove(className)},setDisabled=(element,status)=>{status=!0===status,element.disabled=status},setFadeInEffect=elements=>{elements.forEach(((element,index)=>{addClass(element,"fade-in"),index>0&&addClass(element,`fade-in--${index}`)}))},setFadeInReverseEffect=elements=>{for(let i=elements.length-1,j=0;i>=0;i--,j++)addClass(elements[i],"fade-in"),j>0&&addClass(elements[i],`fade-in--${j}`)},calculateData=(bill,tip,nop)=>{let tipAmount=bill*(tip/100);const totalPerPerson=(bill+tipAmount)/nop,tipPerPerson=tipAmount/nop,data={};return data[tipAmountData.id]=tipPerPerson.toFixed(2),data[totalData.id]=totalPerPerson.toFixed(2),data},renderData=data=>{const tip=data[tipAmountData.id];tipAmountData.textContent=`$${tip}`;const total=data[totalData.id];totalData.textContent=`$${total}`},resetData=()=>{const outData={};outData[tipAmountData.id]="0.00",outData[totalData.id]="0.00",renderData(outData)},writeData=()=>{const bill=Number.parseFloat(billInput.value),nop=Number.parseFloat(numberOfPeopleInput.value),data=calculateData(bill,currentTip,nop);renderData(data),setFadeInEffect(fadeInElements),setDisabled(resetBtn,!1)},tryWriteData=()=>{form.checkValidity()&&writeData()},setShakeEffect=element=>{addClass(element,"shake")},parentOf=input=>input.closest(".form__field"),alertOf=parent=>parent.querySelector(".form__alert"),showInputError=(input,error)=>{const parent=parentOf(input);if(!parent)return;const formAlert=alertOf(parent);formAlert&&(formAlert.textContent=error,input.setAttribute("aria-invalid","true"),input.setAttribute("aria-describedby",formAlert.id),input.focus(),setShakeEffect(input),addClass(parent,"is-invalid"))},clearInputError=input=>{const parent=parentOf(input);if(!parent)return;const formAlert=alertOf(parent);formAlert&&(formAlert.textContent="",input.removeAttribute("aria-invalid"),input.removeAttribute("aria-describedby"),removeClass(parent,"is-invalid"))},validateBill=input=>{const{id:id,value:value}=input,billValue=Number.parseFloat(value);input.checkValidity()&&!Number.isNaN(billValue)?clearInputError(input):showInputError(input,"Enter between 0 and 9999")},validateCustomTip=input=>{const{id:id,value:value}=input;currentTip=Number.parseFloat(value),input.checkValidity()&&!Number.isNaN(currentTip)?clearInputError(input):showInputError(input,"Enter between 0 and 100")},validateNumberOfPeople=input=>{const{id:id,value:value}=input,nop=Number.parseInt(value);input.checkValidity()&&!Number.isNaN(nop)?clearInputError(input):showInputError(input,"Enter between 0 and 100")},resetInput=input=>{clearInputError(input),input.value=""},resetInputs=()=>{inputs.forEach(resetInput)},resetFormFields=()=>{currentTip=0,form.reset()},resetBtnHandler=event=>{setDisabled(event.target,!0),resetData(),setFadeInReverseEffect(fadeInElements),resetFormFields()},shakeAnimationendHandler=event=>{removeClass(event.target,"shake")},fadeInAnimationendHandler=event=>{removeClass(event.target,"fade-in");for(let i=1;i<fadeInElements.length;i++)removeClass(event.target,`fade-in--${i}`)},handleInput=(input,validate)=>{validate(input),tryWriteData()},inputHandlers={};inputHandlers[billInput.id]=event=>{handleInput(event.target,validateBill)},inputHandlers[customTipInput.id]=event=>{removeCheckedRadioInput(),handleInput(event.target,validateCustomTip)},inputHandlers[numberOfPeopleInput.id]=event=>{handleInput(event.target,validateNumberOfPeople)};const selectionTipHandler=event=>{resetInput(customTipInput),currentTip=Number.parseFloat(event.target.value),Number.isNaN(currentTip)?currentTip=0:tryWriteData()};inputs.forEach((input=>{input.addEventListener("input",inputHandlers[input.id]),input.addEventListener("animationend",shakeAnimationendHandler)})),fadeInElements.forEach((element=>{element.addEventListener("animationend",fadeInAnimationendHandler)})),resetBtn.addEventListener("click",resetBtnHandler),radioInputs.forEach((input=>{input.addEventListener("change",selectionTipHandler)}));